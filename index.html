<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Telegraph Drag & Drop (Vercel)</title>

<style>
.dropzone {
    width: 100%;
    padding: 40px;
    border: 3px dashed #888;
    border-radius: 15px;
    background: #fff;
    text-align: center;
    cursor: pointer;
    transition: 0.2s;
}
.dropzone.hover {
    background: #e0ffe0;
    border-color: #3bb33b;
}
#preview {
    max-width: 300px;
    margin-top: 20px;
    display: none;
}
</style>

</head>
<body>

<h2>Upload Gambar â†’ Telegra.ph (Vercel)</h2>

<div id="dropzone" class="dropzone">Drag & drop gambar di sini</div>
<input type="file" id="fileInput" accept="image/*" style="display:none">

<input id="resultURL" readonly style="width:100%; margin-top:10px">
<img id="preview">

<script>
const dropzone = document.getElementById("dropzone");
const fileInput = document.getElementById("fileInput");
const resultURL = document.getElementById("resultURL");
const preview = document.getElementById("preview");

dropzone.onclick = () => fileInput.click();

dropzone.ondragover = e => {
    e.preventDefault();
    dropzone.classList.add("hover");
};
dropzone.ondragleave = () => dropzone.classList.remove("hover");

dropzone.ondrop = e => {
    e.preventDefault();
    dropzone.classList.remove("hover");
    uploadFile(e.dataTransfer.files[0]);
};

fileInput.onchange = () => uploadFile(fileInput.files[0]);

async function uploadFile(file) {
    dropzone.innerHTML = "Uploading...";

    const formData = new FormData();
    formData.append("image", file);

    const res = await fetch("/api/upload", {
        method: "POST",
        body: formData
    });

    const data = await res.json();

    if (data.url) {
        resultURL.value = data.url;
        preview.src = data.url;
        preview.style.display = "block";
        dropzone.innerHTML = "Upload selesai!";
    } else {
        alert("Error: " + data.error);
        dropzone.innerHTML = "Upload gagal!";
    }
}
</script>

</body>
</html>
